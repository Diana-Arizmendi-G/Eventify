<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mensajes - Eventify</title>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
body{
    margin:0;
    font-family:Arial, Helvetica, sans-serif;
    background:#f2f2f2;
}

/* HEADER */
.header{
    background:#1f3a56;
    color:white;
    padding:20px;
    font-size:20px;
    font-weight:bold;
}

/* CHAT LIST */
.chat-list{
    padding:10px;
}

.chat-item{
    background:white;
    padding:15px;
    border-radius:12px;
    margin-bottom:10px;
    display:flex;
    justify-content:space-between;
    align-items:center;
    cursor:pointer;
    transition:0.2s;
}

.chat-item:hover{
    background:#e9eef3;
}

.chat-info{
    display:flex;
    flex-direction:column;
}

.chat-name{
    font-weight:bold;
}

.chat-last{
    font-size:13px;
    color:gray;
    margin-top:5px;
}

.time{
    font-size:12px;
    color:gray;
}

/* NAVBAR */
.navbar{
    position:fixed;
    bottom:0;
    width:100%;
    display:flex;
    justify-content:space-around;
    padding:10px;
    background:white;
    border-top:1px solid #ccc;
}

.navbar i{
    font-size:20px;
}
</style>
</head>

<body>

<div class="header">
    Mensajes
</div>

<div class="chat-list" id="chatList"></div>

<div class="navbar">
<a href="create-event.html">âž•</a>
<a href="search-providers.html">ðŸ”Ž</a>
<a href="messages.html">ðŸ’¬</a>
<a href="reports.html">ðŸ“Š</a>
<a href="profile-organizer.html">ðŸ‘¤</a>
</div>

<script>
const providers = [
    {name:"DJ Alex Sound"},
    {name:"SalÃ³n JardÃ­n Real"},
    {name:"Catering Deluxe"},
    {name:"FotografÃ­a Luna"}
];

const chatList = document.getElementById("chatList");

providers.forEach(provider=>{
    const key = "chat_" + provider.name.replace(/\s/g,"");
    const messages = JSON.parse(localStorage.getItem(key)) || [];

    let lastMessage = "Sin mensajes aÃºn";
    let lastTime = "";

    if(messages.length > 0){
        lastMessage = messages[messages.length-1].text;
        lastTime = messages[messages.length-1].time;
    }

    const div = document.createElement("div");
    div.classList.add("chat-item");
    div.onclick = () => {
        window.location.href = "chat.html?provider=" + provider.name;
    };

    div.innerHTML = `
        <div class="chat-info">
            <div class="chat-name">${provider.name}</div>
            <div class="chat-last">${lastMessage}</div>
        </div>
        <div class="time">${lastTime}</div>
    `;

    chatList.appendChild(div);
});
</script>

</body>
</html>